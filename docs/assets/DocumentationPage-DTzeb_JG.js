import{j as e,Z as p,as as h}from"./ui-Donqwxo7.js";import{r as j}from"./vendor-CW-_dNtU.js";import{b as m,u as f,c as x}from"./query-Cw8NcARV.js";import{C as g,b as N,c as y,a as v,h as u,u as b}from"./index-CmI2uZiO.js";import{B as S}from"./badge-eiixo76M.js";import{B as l}from"./button-gHr9dfwR.js";import{z as c,u as C,t as w}from"./index-DBEqNSC_.js";import{I as d}from"./input-BvEpzQI5.js";import{L as o}from"./label-D7Eeu5EM.js";import{T as D}from"./textarea-Bujwefd-.js";import"./utils-BTGVH9Kg.js";function T({onNew:n}){const a=m(),{data:r=[],isLoading:t}=f({queryKey:["/api/documents"]}),i=x({mutationFn:s=>u("DELETE",`/api/documents/${s}`),onSuccess:()=>a.invalidateQueries({queryKey:["/api/documents"]})});return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Documentation"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"EHS reference documents on SharePoint"})]}),e.jsx(l,{onClick:n,children:"+ Add Document"})]}),t?e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading..."}):r.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-16",children:"No documents yet."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(s=>e.jsxs(g,{className:"flex flex-col",children:[e.jsxs(N,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx(y,{className:"text-sm font-semibold leading-snug",children:s.title}),e.jsx(l,{variant:"ghost",size:"icon",className:"h-6 w-6 shrink-0",onClick:()=>i.mutate(s.id),children:e.jsx(p,{className:"h-3.5 w-3.5 text-muted-foreground"})})]}),e.jsx(S,{variant:"outline",className:"w-fit text-xs",children:s.category})]}),e.jsxs(v,{className:"flex-1 flex flex-col justify-between gap-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-3",children:s.description}),e.jsx(l,{variant:"outline",size:"sm",className:"w-full",asChild:!0,children:e.jsxs("a",{href:s.sharepointUrl,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(h,{className:"h-3.5 w-3.5 mr-1"})," Open in SharePoint"]})})]})]},s.id))})]})}const q=c.object({title:c.string().min(1,"Required"),category:c.string().min(1,"Required"),description:c.string().min(1,"Required"),sharepointUrl:c.string().url("Must be a valid URL")});function E({onSubmit:n,onCancel:a,isLoading:r}){const{register:t,handleSubmit:i,formState:{errors:s}}=C({resolver:w(q),defaultValues:{title:"",category:"",description:"",sharepointUrl:""}});return e.jsxs("form",{onSubmit:i(n),className:"space-y-4 max-w-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{children:"Title"}),e.jsx(d,{...t("title"),placeholder:"e.g. EHS Risk Assessment Template"}),s.title&&e.jsx("p",{className:"text-xs text-destructive",children:s.title.message})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{children:"Category"}),e.jsx(d,{...t("category"),placeholder:"e.g. Templates, Procedures, Policies"}),s.category&&e.jsx("p",{className:"text-xs text-destructive",children:s.category.message})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{children:"Description"}),e.jsx(D,{...t("description"),placeholder:"Brief description of the document...",rows:3}),s.description&&e.jsx("p",{className:"text-xs text-destructive",children:s.description.message})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{children:"SharePoint URL"}),e.jsx(d,{...t("sharepointUrl"),placeholder:"https://..."}),s.sharepointUrl&&e.jsx("p",{className:"text-xs text-destructive",children:s.sharepointUrl.message})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:a,children:"Cancel"}),e.jsx(l,{type:"submit",disabled:r,children:r?"Saving...":"Add Document"})]})]})}function H(){const[n,a]=j.useState(!1),r=m(),{toast:t}=b(),i=x({mutationFn:s=>u("POST","/api/documents",s),onSuccess:()=>{r.invalidateQueries({queryKey:["/api/documents"]}),a(!1),t({title:"Document added."})}});return e.jsx("div",{className:"p-4 sm:p-6",children:n?e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Document"}),e.jsx(E,{onSubmit:s=>i.mutate(s),onCancel:()=>a(!1),isLoading:i.isPending})]}):e.jsx(T,{onNew:()=>a(!0)})})}export{H as default};
